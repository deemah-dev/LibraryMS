<UserControl x:Class="LibraryWPF.Views.BorrowBookView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             FontFamily="Microsoft Sans Serif"
             Background="Transparent"
             HorizontalAlignment="Stretch"
             VerticalAlignment="Stretch">

    <UserControl.Resources>

        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <!-- ── ComboBox ── -->
        <Style x:Key="FilterCombo" TargetType="ComboBox">
            <Setter Property="Height"          Value="38"/>
            <Setter Property="FontFamily"      Value="Microsoft Sans Serif"/>
            <Setter Property="FontSize"        Value="12"/>
            <Setter Property="Foreground"      Value="#37474F"/>
            <Setter Property="Background"      Value="White"/>
            <Setter Property="BorderBrush"     Value="#CFD8DC"/>
            <Setter Property="BorderThickness" Value="1.2"/>
            <Setter Property="Padding"         Value="12,0,4,0"/>
            <Setter Property="Cursor"          Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="28"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter Grid.Column="0"
                                                  Content="{TemplateBinding SelectionBoxItem}"
                                                  Margin="{TemplateBinding Padding}"
                                                  VerticalAlignment="Center"
                                                  IsHitTestVisible="False"/>
                                <Path Grid.Column="1"
                                      Data="M7,10 L12,15 L17,10 Z"
                                      Fill="#90A4AE" Width="10" Height="6"
                                      Stretch="Uniform"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      IsHitTestVisible="False"/>
                                <ToggleButton Grid.ColumnSpan="2"
                                              IsChecked="{Binding IsDropDownOpen,
                                              RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                                              Background="Transparent" BorderThickness="0"
                                              Focusable="False"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"    Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#006064"/>
                            </Trigger>
                            <Trigger Property="IsDropDownOpen" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#006064"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="FontFamily" Value="Microsoft Sans Serif"/>
                        <Setter Property="FontSize"   Value="12"/>
                        <Setter Property="Padding"    Value="12,8"/>
                        <Setter Property="Cursor"     Value="Hand"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E0F7FA"/>
                                <Setter Property="Foreground" Value="#006064"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background"  Value="#B2EBF2"/>
                                <Setter Property="Foreground"  Value="#006064"/>
                                <Setter Property="FontWeight"  Value="Bold"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ── Search TextBox ── -->
        <Style x:Key="SearchBox" TargetType="TextBox">
            <Setter Property="Height"                  Value="38"/>
            <Setter Property="FontFamily"              Value="Microsoft Sans Serif"/>
            <Setter Property="FontSize"                Value="12"/>
            <Setter Property="Foreground"              Value="#37474F"/>
            <Setter Property="Background"              Value="White"/>
            <Setter Property="BorderBrush"             Value="#CFD8DC"/>
            <Setter Property="BorderThickness"         Value="1.2"/>
            <Setter Property="Padding"                 Value="12,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ScrollViewer x:Name="PART_ContentHost"
                                          Margin="{TemplateBinding Padding}"
                                          VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#006064"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ── Read-Only Field (label + value pair) ── -->
        <Style x:Key="ReadOnlyLabel" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Microsoft Sans Serif"/>
            <Setter Property="FontSize"   Value="10.5"/>
            <Setter Property="Foreground" Value="#90A4AE"/>
            <Setter Property="Margin"     Value="0,0,0,4"/>
        </Style>

        <Style x:Key="ReadOnlyValue" TargetType="TextBlock">
            <Setter Property="FontFamily"     Value="Microsoft Sans Serif"/>
            <Setter Property="FontSize"       Value="12.5"/>
            <Setter Property="Foreground"     Value="#37474F"/>
            <Setter Property="FontWeight"     Value="SemiBold"/>
            <Setter Property="TextTrimming"   Value="CharacterEllipsis"/>
        </Style>

        <!-- ── Borrow Button ── -->
        <Style x:Key="BorrowButton" TargetType="Button">
            <Setter Property="Height"          Value="44"/>
            <Setter Property="Background"      Value="#006064"/>
            <Setter Property="Foreground"      Value="White"/>
            <Setter Property="FontFamily"      Value="Microsoft Sans Serif"/>
            <Setter Property="FontSize"        Value="13"/>
            <Setter Property="FontWeight"      Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor"          Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bg"
                                Background="{TemplateBinding Background}"
                                CornerRadius="10">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bg" Property="Background" Value="#00838F"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bg" Property="Background" Value="#004D40"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="bg" Property="Background" Value="#B0BEC5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ── Search Button ── -->
        <Style x:Key="SearchButton" TargetType="Button">
            <Setter Property="Height"          Value="38"/>
            <Setter Property="Background"      Value="#006064"/>
            <Setter Property="Foreground"      Value="White"/>
            <Setter Property="FontFamily"      Value="Microsoft Sans Serif"/>
            <Setter Property="FontSize"        Value="12"/>
            <Setter Property="FontWeight"      Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor"          Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bg"
                                Background="{TemplateBinding Background}"
                                CornerRadius="8" Padding="20,0">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bg" Property="Background" Value="#00838F"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bg" Property="Background" Value="#004D40"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </UserControl.Resources>

    <!-- ═══════════════════════════════════════════════════════
         ROOT ScrollViewer — يضمن ظهور المحتوى عند تصغير الشاشة
         ═══════════════════════════════════════════════════════ -->
    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
        <Grid>
            <Grid.RowDefinitions>
                <!-- Search Card -->
                <RowDefinition Height="Auto"/>
                <!-- Details Card — يظهر بعد البحث -->
                <RowDefinition Height="Auto"/>
                <!-- Borrow Info Card -->
                <RowDefinition Height="Auto"/>
                <!-- Borrow Button -->
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- ══════════════════════════════════
                 ROW 0 — Search Card
                 ══════════════════════════════════ -->
            <Border Grid.Row="0"
                    Background="White" CornerRadius="14"
                    Padding="24,20" Margin="0,0,0,16">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="12" ShadowDepth="2"
                                      Opacity="0.08" Color="Black"/>
                </Border.Effect>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Section Title -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                        <Border Width="4" CornerRadius="2" Background="#006064" Margin="0,0,10,0"/>
                        <StackPanel>
                            <TextBlock Text="Book Search"
                                       FontFamily="Microsoft Sans Serif"
                                       FontSize="14" FontWeight="Bold"
                                       Foreground="#006064"/>
                            <TextBlock Text="Search for the book you want to borrow"
                                       FontFamily="Microsoft Sans Serif"
                                       FontSize="10.5" Foreground="#90A4AE"
                                       Margin="0,2,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Search Controls -->
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <!-- Search Type Label -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- Search Type ComboBox -->
                            <ColumnDefinition Width="140"/>
                            <!-- Search Input -->
                            <ColumnDefinition Width="*"/>
                            <!-- Search Button -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- Clear Button -->
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0"
                                   Text="Search by:"
                                   FontFamily="Microsoft Sans Serif"
                                   FontSize="12" Foreground="#78909C"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0"/>

                        <!-- Search Type ComboBox -->
                        <ComboBox Grid.Column="1"
                                  Style="{StaticResource FilterCombo}"
                                  ItemsSource="{Binding SearchTypeOptions}"
                                  SelectedItem="{Binding SelectedSearchType}"
                                  Margin="0,0,10,0"/>

                        <!-- Search Text Input -->
                        <TextBox Grid.Column="2"
                                 Style="{StaticResource SearchBox}"
                                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                 Margin="0,0,10,0"/>

                        <!-- Search Button -->
                        <Button Grid.Column="3"
                                Style="{StaticResource SearchButton}"
                                Command="{Binding SearchCommand}"
                                Margin="0,0,8,0">
                            <StackPanel Orientation="Horizontal" Margin="18,0">
                                <Path Data="M15.5,14 L14.71,14 L14.43,13.73 C15.41,12.59 16,11.11 16,9.5 C16,5.91 13.09,3 9.5,3 C5.91,3 3,5.91 3,9.5 C3,13.09 5.91,16 9.5,16 C11.11,16 12.59,15.41 13.73,14.43 L14,14.71 L14,15.5 L19,20.49 L20.49,19 L15.5,14 Z M9.5,14 C7.01,14 5,11.99 5,9.5 C5,7.01 7.01,5 9.5,5 C11.99,5 14,7.01 14,9.5 C14,11.99 11.99,14 9.5,14 Z"
                                      Fill="White" Width="13" Height="13"
                                      Stretch="Uniform" Margin="0,0,7,0"/>
                                <TextBlock Text="Search" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>

                        <!-- Clear Button -->
                        <Button Grid.Column="4"
                                Height="38" Background="#F4F6F8"
                                Foreground="#78909C"
                                FontFamily="Microsoft Sans Serif"
                                FontSize="12" BorderThickness="0"
                                Cursor="Hand"
                                Command="{Binding ClearSearchCommand}">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="bg"
                                            Background="{TemplateBinding Background}"
                                            CornerRadius="8" Padding="16,0">
                                        <ContentPresenter HorizontalAlignment="Center"
                                                          VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="bg" Property="Background" Value="#E0E0E0"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                            <TextBlock Text="Clear"/>
                        </Button>

                    </Grid>
                </Grid>
            </Border>

            <!-- ══════════════════════════════════════════════════════
                 ROW 1 — Book Details Card
                 يظهر فقط عند نجاح البحث (IsBookFound = True)
                 ══════════════════════════════════════════════════════ -->
            <Border Grid.Row="1"
                    Visibility="{Binding IsBookFound, Converter={StaticResource BoolToVis}}"
                    Background="White" CornerRadius="14"
                    Padding="24,20" Margin="0,0,0,16">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="12" ShadowDepth="2"
                                      Opacity="0.08" Color="Black"/>
                </Border.Effect>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Section Title -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,18">
                        <Border Width="4" CornerRadius="2" Background="#00838F" Margin="0,0,10,0"/>
                        <StackPanel>
                            <TextBlock Text="Book Details"
                                       FontFamily="Microsoft Sans Serif"
                                       FontSize="14" FontWeight="Bold"
                                       Foreground="#006064"/>
                            <TextBlock Text="Information about the selected book"
                                       FontFamily="Microsoft Sans Serif"
                                       FontSize="10.5" Foreground="#90A4AE"
                                       Margin="0,2,0,0"/>
                        </StackPanel>

                        <!-- Available badge -->
                        <Border Background="#E8F5E9" CornerRadius="20"
                                Padding="14,5" Margin="16,0,0,0"
                                VerticalAlignment="Center"
                                Visibility="{Binding IsCopyAvailable, Converter={StaticResource BoolToVis}}">
                            <StackPanel Orientation="Horizontal">
                                <Ellipse Width="7" Height="7" Fill="#2E7D32" Margin="0,0,6,0"/>
                                <TextBlock Text="Copy Available"
                                           FontFamily="Microsoft Sans Serif"
                                           FontSize="11" FontWeight="Bold"
                                           Foreground="#2E7D32"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Row 1: Title / SubTitle / ISBN / Category -->
                    <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,16">

                        <!-- Title -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Title"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8">
                                <TextBlock Style="{StaticResource ReadOnlyValue}"
                                           Text="{Binding FoundBook.Title}"/>
                            </Border>
                        </StackPanel>

                        <!-- SubTitle -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Subtitle"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8">
                                <TextBlock Style="{StaticResource ReadOnlyValue}"
                                           Text="{Binding FoundBook.SubTitle}"/>
                            </Border>
                        </StackPanel>

                        <!-- ISBN -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="ISBN"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8">
                                <TextBlock Style="{StaticResource ReadOnlyValue}"
                                           Text="{Binding FoundBook.ISBN}"
                                           FontFamily="Courier New" FontSize="12"/>
                            </Border>
                        </StackPanel>

                        <!-- Category -->
                        <StackPanel>
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Category"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8">
                                <TextBlock Style="{StaticResource ReadOnlyValue}"
                                           Text="{Binding FoundBook.CategoryName}"/>
                            </Border>
                        </StackPanel>

                    </UniformGrid>

                    <!-- Row 2: Author / PublishDate / AdditionalDetails / Copies -->
                    <UniformGrid Grid.Row="2" Columns="4">

                        <!-- Author -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Author"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8">
                                <TextBlock Style="{StaticResource ReadOnlyValue}"
                                           Text="{Binding FoundBook.AuthorName}"/>
                            </Border>
                        </StackPanel>

                        <!-- Publish Date -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Publish Date"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8">
                                <TextBlock Style="{StaticResource ReadOnlyValue}"
                                           Text="{Binding FoundBook.PublishDate, StringFormat='dd MMM yyyy'}"/>
                            </Border>
                        </StackPanel>

                        <!-- Total / Available Copies -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Copies  (Total / Available)"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding FoundBook.TotalCopies}"
                                               FontFamily="Microsoft Sans Serif"
                                               FontSize="12.5" FontWeight="Bold"
                                               Foreground="#37474F"/>
                                    <TextBlock Text=" / "
                                               FontFamily="Microsoft Sans Serif"
                                               FontSize="12.5" Foreground="#90A4AE"/>
                                    <TextBlock Text="{Binding FoundBook.AvailableCopies}"
                                               FontFamily="Microsoft Sans Serif"
                                               FontSize="12.5" FontWeight="Bold">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="#2E7D32"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding FoundBook.AvailableCopies}" Value="0">
                                                        <Setter Property="Foreground" Value="#C62828"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Additional Details -->
                        <StackPanel>
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Additional Details"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8">
                                <TextBlock Style="{StaticResource ReadOnlyValue}"
                                           Text="{Binding FoundBook.AdditionalDetails}"
                                           TextWrapping="Wrap" MaxHeight="38"/>
                            </Border>
                        </StackPanel>

                    </UniformGrid>
                </Grid>
            </Border>

            <!-- ══════════════════════════════════════════════════════
                 ROW 2 — Borrow Info Card
                 يظهر فقط عند نجاح البحث (IsBookFound = True)
                 ══════════════════════════════════════════════════════ -->
            <Border Grid.Row="2"
                    Visibility="{Binding IsBookFound, Converter={StaticResource BoolToVis}}"
                    Background="White" CornerRadius="14"
                    Padding="24,20" Margin="0,0,0,16">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="12" ShadowDepth="2"
                                      Opacity="0.08" Color="Black"/>
                </Border.Effect>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Section Title -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,18">
                        <Border Width="4" CornerRadius="2" Background="#00ACC1" Margin="0,0,10,0"/>
                        <StackPanel>
                            <TextBlock Text="Borrow Information"
                                       FontFamily="Microsoft Sans Serif"
                                       FontSize="14" FontWeight="Bold"
                                       Foreground="#006064"/>
                            <TextBlock Text="Details that will be recorded for this borrowing transaction"
                                       FontFamily="Microsoft Sans Serif"
                                       FontSize="10.5" Foreground="#90A4AE"
                                       Margin="0,2,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Borrow Fields: Username / CopyId / BorrowDate / DueDate -->
                    <UniformGrid Grid.Row="1" Columns="4">

                        <!-- Username -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Username"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8"
                                    BorderBrush="#E0F7FA" BorderThickness="1.2">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="M12,12 C14.21,12 16,10.21 16,8 C16,5.79 14.21,4 12,4 C9.79,4 8,5.79 8,8 C8,10.21 9.79,12 12,12 Z M12,14 C9.33,14 4,15.34 4,18 L4,20 L20,20 L20,18 C20,15.34 14.67,14 12,14 Z"
                                          Fill="#00ACC1" Width="13" Height="13"
                                          Stretch="Uniform" Margin="0,0,7,0"
                                          VerticalAlignment="Center"/>
                                    <TextBlock Style="{StaticResource ReadOnlyValue}"
                                               Text="{Binding BorrowInfo.Username}"
                                               Foreground="#006064"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Copy ID -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Copy ID"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8"
                                    BorderBrush="#E0F7FA" BorderThickness="1.2">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="M4,6 L4,20 C4,21.1 4.9,22 6,22 L18,22 C19.1,22 20,21.1 20,20 L20,8 L14,2 L6,2 C4.9,2 4,2.9 4,4 Z M13,9 L13,3.5 L18.5,9 L13,9 Z"
                                          Fill="#00ACC1" Width="13" Height="13"
                                          Stretch="Uniform" Margin="0,0,7,0"
                                          VerticalAlignment="Center"/>
                                    <TextBlock Style="{StaticResource ReadOnlyValue}"
                                               Text="{Binding BorrowInfo.CopyId}"
                                               Foreground="#006064"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Borrow Date -->
                        <StackPanel Margin="0,0,20,0">
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Borrow Date"/>
                            <Border Background="#F4F6F8" CornerRadius="8" Padding="12,8"
                                    BorderBrush="#E0F7FA" BorderThickness="1.2">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="M20,6 L4,6 C2.9,6 2,6.9 2,8 L2,20 C2,21.1 2.9,22 4,22 L20,22 C21.1,22 22,21.1 22,20 L22,8 C22,6.9 21.1,6 20,6 Z M20,20 L4,20 L4,10 L20,10 L20,20 Z M16,1 L8,1 L8,3 L16,3 L16,1 Z"
                                          Fill="#00ACC1" Width="13" Height="13"
                                          Stretch="Uniform" Margin="0,0,7,0"
                                          VerticalAlignment="Center"/>
                                    <TextBlock Style="{StaticResource ReadOnlyValue}"
                                               Text="{Binding BorrowInfo.BorrowDate, StringFormat='dd MMM yyyy'}"
                                               Foreground="#006064"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Due Date -->
                        <StackPanel>
                            <TextBlock Style="{StaticResource ReadOnlyLabel}" Text="Due Date"/>
                            <Border CornerRadius="8" Padding="12,8"
                                    BorderThickness="1.2">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background"   Value="#FFF8E1"/>
                                        <Setter Property="BorderBrush"  Value="#FFE082"/>
                                    </Style>
                                </Border.Style>
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z M12.5,7 L11,7 L11,13 L16.25,16.15 L17,14.92 L12.5,12.25 L12.5,7 Z"
                                          Fill="#F9A825" Width="13" Height="13"
                                          Stretch="Uniform" Margin="0,0,7,0"
                                          VerticalAlignment="Center"/>
                                    <TextBlock Style="{StaticResource ReadOnlyValue}"
                                               Text="{Binding BorrowInfo.DueDate, StringFormat='dd MMM yyyy'}"
                                               Foreground="#F57F17"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                    </UniformGrid>
                </Grid>
            </Border>

            <!-- ══════════════════════════════════
                 ROW 3 — Borrow Button
                 ══════════════════════════════════ -->
            <Border Grid.Row="3"
                    Visibility="{Binding IsBookFound, Converter={StaticResource BoolToVis}}"
                    Margin="0,0,0,4">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="220"/>
                    </Grid.ColumnDefinitions>

                    <!-- Hint text -->
                    <StackPanel Grid.Column="0" VerticalAlignment="Center" Margin="4,0,0,0">
                        <TextBlock FontFamily="Microsoft Sans Serif"
                                   FontSize="11.5" Foreground="#90A4AE">
                            <Run Text="Borrowing will be recorded for "/>
                            <Run Text="{Binding BorrowInfo.Username}"
                                 FontWeight="Bold" Foreground="#006064"/>
                        </TextBlock>
                        <TextBlock FontFamily="Microsoft Sans Serif"
                                   FontSize="10.5" Foreground="#B0BEC5"
                                   Margin="0,2,0,0"
                                   Text="Make sure all details are correct before confirming."/>
                    </StackPanel>

                    <!-- Borrow Button -->
                    <Button Grid.Column="1"
                            Style="{StaticResource BorrowButton}"
                            Command="{Binding BorrowCommand}"
                            IsEnabled="{Binding IsCopyAvailable}">
                        <StackPanel Orientation="Horizontal" Margin="24,0">
                            <Path Data="M20,6 L4,6 C2.9,6 2,6.9 2,8 L2,20 C2,21.1 2.9,22 4,22 L20,22 C21.1,22 22,21.1 22,20 L22,8 C22,6.9 21.1,6 20,6 Z M20,20 L4,20 L4,10 L20,10 L20,20 Z M16,1 L8,1 L8,3 L16,3 L16,1 Z"
                                  Fill="White" Width="16" Height="16"
                                  Stretch="Uniform" Margin="0,0,10,0"/>
                            <TextBlock Text="Confirm Borrow" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </Grid>
            </Border>

        </Grid>
    </ScrollViewer>

</UserControl>